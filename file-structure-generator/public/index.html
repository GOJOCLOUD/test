<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>File Structure Generator</title>
  <link rel="stylesheet" href="style.css?v=4.0" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div class="app-wrapper">
    <!-- 顶部导航栏 -->
    <header class="nav-header">
      <h1>File Structure Generator</h1>
      <div class="nav-actions">
        <button class="icon-btn">
          <i class="fas fa-info-circle"></i>
        </button>
        <button class="icon-btn">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </header>
    
    <!-- 主要内容网格 -->
    <div class="content-grid">
      <!-- 编辑器卡片 -->
      <div class="editor-card">
        <div class="card-header">
          <h2 class="card-title">文件结构编辑器</h2>
          <span class="card-badge">输入</span>
        </div>
        <div class="card-body">
          <textarea id="input" class="apple-textarea" placeholder="在此输入文件结构，例如：
my-project/
├─ src/
│  ├─ components/
│  │  ├─ Header.js
│  │  └─ Footer.js
│  └─ utils/
│     └─ helpers.js
├─ public/
│  └─ index.html
├─ package.json
└─ README.md"></textarea>
          
          <!-- 按钮组 -->
          <div class="button-stack">
            <button id="generate" class="apple-btn btn-primary">
              <i class="fas fa-code"></i>
              生成 PowerShell 脚本
            </button>
            <button id="clear" class="apple-btn btn-secondary">
              <i class="fas fa-trash"></i>
              清空
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 示例区域 -->
    <section class="examples-section">
      <div class="section-header">
        <h2 class="section-title">使用示例</h2>
        <p class="section-subtitle">复制以下示例或创建您自己的文件结构</p>
      </div>
      
      <div class="examples-grid">
        <div class="example-card">
          <div class="example-header">
            <h3 class="example-title">
              <i class="fab fa-react"></i>
              React 应用示例
              <span class="example-badge">热门</span>
            </h3>
          </div>
          <div class="code-block">
my-react-app/
├─ public/
│  ├─ index.html
│  └─ favicon.ico
├─ src/
│  ├─ components/
│  │  ├─ App.js
│  │  └─ Button.js
│  ├─ styles/
│  │  └─ main.css
│  └─ index.js
├─ package.json
└─ README.md
          </div>
        </div>
        
        <div class="example-card">
          <div class="example-header">
            <h3 class="example-title">
              <i class="fab fa-node-js"></i>
              Node API 示例
              <span class="example-badge">API</span>
            </h3>
          </div>
          <div class="code-block">
node-api/
├─ src/
│  ├─ controllers/
│  ├─ models/
│  ├─ routes/
│  ├─ middleware/
│  └─ app.js
├─ config/
│  └─ db.js
├─ package.json
└─ README.md
          </div>
        </div>
      </div>
    </section>
    
    <!-- 底部 -->
    <footer class="footer">
      <p>© 2023 File Structure Generator | <a href="#" class="footer-link">了解更多</a></p>
    </footer>
  </div>
  
  <!-- 状态提示 -->
  <div id="status" class="status-toast processing">
    <div class="status-icon"></div>
    <div class="status-text">系统就绪</div>
  </div>

  <script>
    // DOM元素获取
    const input = document.getElementById('input');
    const generateBtn = document.getElementById('generate');
    const clearBtn = document.getElementById('clear');
    const statusToast = document.getElementById('status');
    
    // 设置欢迎消息
    document.addEventListener('DOMContentLoaded', () => {
      showStatus('系统就绪', 'ready');
    });
    
    // 生成按钮点击事件
    generateBtn.addEventListener('click', () => {
      const fileStructure = input.value.trim();
      
      if (!fileStructure) {
        showStatus('请输入文件结构', 'error');
        return;
      }
      
      showStatus('正在生成脚本...', 'processing');
      
      // 模拟处理延迟
      setTimeout(() => {
        const scriptContent = generatePowerShellScript(fileStructure);
        const blob = new Blob([scriptContent], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        
        // 创建下载链接并点击
        const a = document.createElement('a');
        a.href = url;
        a.download = 'create_file_structure.ps1';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showStatus('脚本生成成功并已下载', 'success');
      }, 1000);
    });
    
    // 清空按钮点击事件
    clearBtn.addEventListener('click', () => {
      input.value = '';
      showStatus('输入已清空', 'info');
    });
    
    // 生成PowerShell脚本
    function generatePowerShellScript(fileStructure) {
      const lines = fileStructure.split('\n');
      let script = '$ErrorActionPreference = "Stop"\n\n';
      script += '# 创建文件结构的PowerShell脚本\n';
      script += '# 由File Structure Generator生成\n\n';
      
      let currentPath = '.';
      const pathStack = [];
      
      // 解析文件结构并生成命令
      for (const line of lines) {
        const trimmedLine = line.trim();
        if (!trimmedLine) continue;
        
        // 计算缩进级别
        const indentLevel = Math.floor((line.match(/│/g) || []).length);
        
        // 处理目录
        if (trimmedLine.endsWith('/') || trimmedLine.endsWith('\\')) {
          const dirName = trimmedLine.replace(/^[├└]─\s*/, '').replace(/[/\\]$/, '');
          
          // 更新当前路径
          while (pathStack.length > indentLevel) {
            pathStack.pop();
          }
          pathStack.push(dirName);
          currentPath = pathStack.join('\\');
          
          script += `Write-Host "创建目录: ${currentPath}"\n`;
          script += `New-Item -ItemType Directory -Path ".\\${currentPath}" -Force | Out-Null\n`;
        } else {
          // 处理文件
          const fileName = trimmedLine.replace(/^[├└]─\s*/, '');
          const filePath = `${pathStack.join('\\')}\\${fileName}`;
          
          script += `Write-Host "创建文件: ${filePath}"\n`;
          script += `New-Item -ItemType File -Path ".\\${filePath}" -Force | Out-Null\n`;
        }
      }
      
      script += '\nWrite-Host "文件结构创建完成!" -ForegroundColor Green\n';
      return script;
    }
    
    // 显示状态消息
    function showStatus(message, type) {
      const statusText = statusToast.querySelector('.status-text');
      statusText.textContent = message;
      
      // 移除所有类型类
      statusToast.classList.remove('ready', 'processing', 'success', 'error', 'info');
      
      // 添加新类型类
      statusToast.classList.add(type);
      
      // 重置状态消息可见性
      statusToast.style.display = 'flex';
      statusToast.style.opacity = '1';
      statusToast.style.transform = 'translateY(0)';
      
      // 5秒后自动隐藏消息
      setTimeout(() => {
        statusToast.style.opacity = '0';
        statusToast.style.transform = 'translateY(-20px)';
        setTimeout(() => {
          statusToast.style.display = 'none';
        }, 300);
      }, 5000);
    }
  </script>
</body>
</html>
